#include <stdio.h>
#include <string.h>
#include <stdint.h>
#include "lea.h"

void test1()
{
	LEA_KEY key;

	unsigned char K[16] = { 0x0f, 0x1e, 0x2d, 0x3c, 0x4b, 0x5a, 0x69, 0x78, 0x87, 0x96, 0xa5, 0xb4, 0xc3, 0xd2, 0xe1, 0xf0 };
	uint8_t P1[16] = { 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f };
	unsigned char C[16] = { 0 };
	unsigned char D[16] = { 0 };
	//unsigned char K[16] = { 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//uint8_t P1[16] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

	uint32_t P2[4] = { 0x13121110, 0x17161514, 0x1b1a1918, 0x1f1e1d1c };
	uint64_t P3[2] = { 0x1716151413121110, 0x1f1e1d1c1b1a1918 };

	KeySchedule(K, 128, &key);
	printRK(&key);

	LEA_encrypt((uint64_t*)P1, C, &key);
	LEA_decrypt((uint64_t*)C, D, &key);
}

void test2()
{
	LEA_ecb_KAT();
	LEA_ecb_MMT();
	LEA_ecb_MCT();

	LEA_cbc_KAT();
	LEA_cbc_MMT();
	LEA_cbc_MCT();

	LEA_ctr_KAT();
	LEA_ctr_MMT();
	LEA_ctr_MCT();
}

int main()
{
	
	//test1();
	test2();

	return 0;
}